<!doctype html>
<!--
    Cook Family Recipes — Home page
    Developer notes: The comments in this file label major sections (head, styles, header, nav, hero, recipes grid, footer, scripts).
    These are HTML comments and will not be rendered in the browser; they are visible only when viewing the source.
-->
<html lang="en">
<!-- ===== HEAD: metadata, title, and in-page styles ===== -->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cook Family Recipes • Home</title>
    <!-- ===== SHARED STYLESHEET ===== -->
    <link rel="stylesheet" href="styles.css">
    <!-- site icon -->
    <link rel="icon" href="Icon.jpg" type="image/jpeg">
    <link rel="apple-touch-icon" href="Icon.jpg">
</head>
<body>
    <!-- ===== PAGE CONTAINER ===== -->
    <div class="container">
        <!-- ===== HEADER: brand and main navigation ===== -->
        <header>
            <a href="Cook Family Recipes.html" class="brand">
                <img src="Icon.jpg" class="logo" alt="Cook Family Recipes logo">
                <div>
                    <div class="brand-title">Cook Family Recipes</div>
                    <div class="brand-sub">Cooking made easy</div>
                </div>
            </a>
            <!-- ===== NAVIGATION: main links ===== -->
            <nav aria-label="Main navigation">
                <a href="Cook Family Recipes.html">Home</a>
                <a href="recipes.html">Recipes</a>
                <a href="categories.html">Categories</a>
                <a href="portfolio.html">Portfolio</a>
                <a href="about.html">About</a>
            </nav>
    </header>

    <!-- ===== HERO: search, lead text, featured tags ===== -->
    <section class="hero" aria-labelledby="hero-title">
            <div class="hero-card">
                <h1 id="hero-title">Find your next favorite meal</h1>
                <p class="lead">Browse simple, tested recipes with clear steps and pictures. Filter by ingredient, cuisine or difficulty.</p>

                <p style="margin-top:12px" class="lead">Use the full search page to explore all recipes and filters.</p>
                <p style="margin-top:8px"><a href="search.html" class="button">Search all recipes</a></p>
            </div>

    </section>

    <!-- ===== RECIPES GRID: list of recipe cards (click to open) ===== -->
    <h2 style="margin-top:28px">Favourite Recipes</h2>
    <div class="grid" id="recipes">
        <!-- recipe cards will be mounted here from recipes-data.js via FILTER.mountRecipesFromData -->
    </div>

    <!-- Load more removed: pagination not needed on homepage -->

    <!-- include canonical recipes data so we can generate tag chips and support URL-sync -->
    <script src="recipes-data.js"></script>
    <script src="recipes-slug-map.js"></script>
    <script src="favorites-config.js"></script>
    <script src="js/filter-render.js"></script>

    <!-- ===== FOOTER: copyright and small print ===== -->
    <footer>
            © <span id="year"></span>&nbsp;Cook Family Recipes — Simple, tested home cooking.
        </footer>
    </div>

    <!-- Lightweight homepage script: mount recipes and set year (search moved to search.html) -->
    <script>
        function initHomepage() {
            console.log('[homepage] initHomepage called');
            console.log('[homepage] window.RECIPES:', window.RECIPES ? window.RECIPES.length + ' recipes' : 'undefined');
            console.log('[homepage] window.FAVORITE_RECIPES:', window.FAVORITE_RECIPES);
            
            // Set year
            const yearEl = document.getElementById('year');
            if(yearEl) yearEl.textContent = new Date().getFullYear();
            
            const container = document.getElementById('recipes');
            if(!container) {
                console.error('[homepage] Container #recipes not found');
                return;
            }
            
            const favoritesTitles = window.FAVORITE_RECIPES || [];
            const allRecipes = window.RECIPES || [];
            
            console.log('[homepage] favoritesTitles:', favoritesTitles);
            console.log('[homepage] allRecipes:', allRecipes.length);
            
            // Filter recipes to only show favorites, in order of the config
            const filteredRecipes = [];
            for(let i = 0; i < favoritesTitles.length; i++) {
                const title = favoritesTitles[i];
                for(let j = 0; j < allRecipes.length; j++) {
                    if(allRecipes[j].title === title) {
                        filteredRecipes.push(allRecipes[j]);
                        break;
                    }
                }
            }
            
            console.log('[homepage] filteredRecipes:', filteredRecipes.length);
            
            // Clear container
            container.innerHTML = '';
            
            // Render each recipe
            for(let i = 0; i < filteredRecipes.length; i++) {
                const r = filteredRecipes[i];
                const link = document.createElement('a');
                link.className = 'card';
                link.href = 'recipe.html?title=' + encodeURIComponent(r.title);
                link.innerHTML = `
                    <div class="thumb" style="background-image:url('${r.img}')" role="img" aria-label="${r.title}"></div>
                    <div class="card-body">
                        <div style="font-weight:700">${r.title}</div>
                        <div class="meta"><span>${r.time}</span><span>${r.difficulty}</span></div>
                        <div style="color:var(--muted);font-size:14px">${r.desc}</div>
                    </div>
                `;
                container.appendChild(link);
            }
            
            console.log('[homepage] Rendered ' + container.children.length + ' cards');
        }
        
        // Call on DOMContentLoaded to ensure all scripts are loaded
        if(document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initHomepage);
        } else {
            initHomepage();
        }
    </script>
</body>
</html>
