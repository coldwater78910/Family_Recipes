<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Search • Cook Family Recipes</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="Icon.jpg" type="image/jpeg">
    <link rel="apple-touch-icon" href="Icon.jpg">
</head>
<body>
    <div class="container">
        <header>
            <a href="Cook Family Recipes.html" class="brand">
                <img src="Icon.jpg" class="logo" alt="Cook Family Recipes logo">
                <div>
                    <div class="brand-title">Cook Family Recipes</div>
                    <div class="brand-sub">Cooking made easy</div>
                </div>
            </a>
            <nav aria-label="Main navigation">
                <a href="Cook Family Recipes.html">Home</a>
                <a href="recipes.html">Recipes</a>
                <a href="categories.html">Categories</a>
                <a href="about.html">About</a>
            </nav>
        </header>

        <main>
            <h1 class="page-title">Search recipes</h1>

            <form class="search" role="search" action="search.html" method="get">
                <input id="q" name="q" type="search" placeholder="Search recipes, e.g. 'lemon chicken' or 'vegan'">
                <button type="submit">Search</button>
            </form>

            <div id="results" class="grid" aria-live="polite"></div>

            <p style="margin-top:20px"><a class="back-link" href="Cook Family Recipes.html">Back to Home</a></p>
        </main>

        <footer>
            © <span id="year"></span>&nbsp;Cook Family Recipes — Simple, tested home cooking.
        </footer>
    </div>

    <script src="recipes-data.js"></script>
    <script src="recipes-slug-map.js"></script>
    <script src="js/filter-render.js"></script>
    <!-- Fallback shim: define a minimal doSearchAndRender so clients that fail to
         load the external `js/search-client.js` still have a usable function.
         The real `js/search-client.js` will overwrite this if it loads. -->
    <script>
        if(typeof window.doSearchAndRender !== 'function'){
            window.doSearchAndRender = function(qv){
                try{
                    const resultsEl = document.getElementById('results');
                    const qterm = (qv||'').toString().trim().toLowerCase();
                    const list = qterm ? (window.RECIPES || []).filter(r=> (r.title||'').toLowerCase().includes(qterm) || (r.tags||'').toLowerCase().includes(qterm)) : (window.RECIPES || []);
                    if(window.FILTER){ if(resultsEl) FILTER.renderList(resultsEl, list); }
                    else if(resultsEl){
                        resultsEl.innerHTML = list.map(r=> `\
                            <a class="card" href="recipe.html?title=${encodeURIComponent(r.title)}">\
                                <div class="thumb" style="background-image:url('${r.img}')" role="img" aria-label="${r.title}"></div>\
                                <div class="card-body">\
                                    <div class="card-title">${r.title}</div>\
                                    <div class="meta"><span>${r.time}</span><span>${r.difficulty}</span></div>\
                                    <div class="small-muted">${r.desc}</div>\
                                </div>\
                            </a>\
                        `).join('');
                    }
                }catch(e){
                    console.warn('search fallback render failed', e);
                }
            };
        }
    </script>
    <script src="js/search-client.js?v=1763660000"></script>
    <script>
        // set year
        document.getElementById('year').textContent = new Date().getFullYear();

        // initialize input value from URL and render initial results using the extracted helper
        function qs(name){ const params = new URLSearchParams(location.search); return params.get(name) || ''; }
        const q = qs('q');
        var qinput = document.getElementById('q');
        if(qinput) qinput.value = q;
        if(typeof window.doSearchAndRender === 'function') window.doSearchAndRender(q);
        else {
            const results = (q && q.trim()) ? (window.RECIPES || []).filter(r=> (r.title||'').toLowerCase().includes(q.toLowerCase()) || (r.tags||'').toLowerCase().includes(q.toLowerCase())) : (window.RECIPES || []);
            if(window.FILTER) FILTER.renderList(document.getElementById('results'), results);
            else {
                const el = document.getElementById('results');
                el.innerHTML = results.map(r=> `\
                    <a class="card" href="recipe.html?title=${encodeURIComponent(r.title)}">\
                        <div class="thumb" style="background-image:url('${r.img}')" role="img" aria-label="${r.title}"></div>\
                        <div class="card-body">\
                            <div class="card-title">${r.title}</div>\
                            <div class="meta"><span>${r.time}</span><span>${r.difficulty}</span></div>\
                            <div class="small-muted">${r.desc}</div>\
                        </div>\
                    </a>\
                `).join('');
            }
        }
    </script>
</body>
</html>